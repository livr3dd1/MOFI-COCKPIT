## MADE BY KILLUA ON GITHUB.COM!!

#      ⠀⠀⠀⢀⣤⡦⢲⣶⠟⠁⠀⣠⠀⠸⡱⡐⢶⡄⠀⢤⠀⠐⢄⠀⠀⠀⠀⢄⠀⠀⠀⢄⠀⠠⢤⡀⠀⠙⢿⣦⣀⣀⣀⡀⠀⠀⠀
#     ⠀⠀⢀⡴⠃⢀⣤⣤⡴⠋⠁⣴⠟⢁⡔⢁⡴⠁⠀⠀⠱⣱⠀⠹⣄⠄⠱⣄⠈⠣⡙⢦⠀⠈⠳⣄⠁⠈⠳⣜⣄⠉⠓⢤⣀⠀⠈⠀⠀⠀
#    ⢀⣴⡯⠴⠚⣫⡿⠋⠀⣠⡞⠃⣠⠎⣰⠟⠀⠀⠀⠀⠀⠱⠁⠀⠹⡿⣆⠈⠣⡀⠀⠀⠑⢄⠀⠈⠣⣀⠀⠈⢫⡓⢄⡀⢈⡑⠲⠤⠀⠀⠀
#⠀⠀⠀⢠⣾⠏⠀⣠⣾⡿⢀⣼⠏⣰⠋⢀⡆⢰⠀⣆⠃⠀⠀⡄⠀⠀⠈⣷⠀⠈⠢⢀⠀⠀⢳⠀⠀⠈⢦⡀⠀⢿⠦⢹⡦⠈⠑⣶⡖⠚⠛⠁⠀
#⠀⠀⡰⠻⢁⡴⠻⣿⡿⢁⡞⠘⢀⠇⣼⣿⡇⣸⣄⣿⠀⢦⡀⢹⡖⣴⣄⠘⣧⠀⢣⡈⢱⡄⠘⣷⡀⠀⢠⡱⣄⠈⢷⡄⠈⣿⡀⠸⡏⠒⠀⠀⠀
#⠀⠀⢠⡾⠁⠀⢰⣟⡴⠋⡔⢰⢺⠀⣿⣿⣇⠺⣿⣿⡆⠘⣧⠈⣿⣜⣿⣧⡘⣷⡀⢻⣧⡹⡄⠈⢿⢄⠀⣹⣎⣷⣬⣿⣦⠹⣿⣦⡘⣆⠀⠀⠀
#⠀⠀⠋⠀⠀⢠⣿⠏⠀⣼⢁⡟⡏⢸⣿⠻⣿⣿⣏⣿⣿⡄⢻⣧⢹⡟⣿⣿⣿⣿⣷⣄⣿⣿⣿⣄⠈⢯⢧⣡⣿⣏⠳⣼⠙⣷⡿⣍⠛⠛⢦⡀⠀
#⠀⠀⠀⠀⠀⡾⠃⠀⡿⢱⡾⣿⣠⡺⣿⡀⢸⣿⣿⡿⠻⣿⣼⣏⢻⣿⢿⣿⣿⣿⣿⡟⠻⢿⡿⢿⣷⣈⣻⣿⣼⣿⢳⢸⠀⢸⣿⡈⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠃⠀⢰⠃⢸⠁⡇⢸⣿⠉⢳⡀⠙⠛⠻⠀⠙⠹⡟⠈⠇⠀⠻⠿⠿⠟⠁⣠⠞⠁⠠⣿⠿⡟⢈⣿⣭⢏⡼⢀⡼⠻⢷⣄⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠈⠀⠸⠀⡇⢸⢻⣆⠀⠙⠓⠖⠂⢠⠀⠀⠉⠀⠀⠘⢶⣦⣤⠶⠚⠁⠀⠀⠠⣿⣼⣿⢦⣈⣤⣫⣶⣏⠁⠀⠀⠈⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠘⠸⣿⣀⡈⠁⠀⢴⡋⠀⠀⠀⠀⠀⠩⣿⡿⠛⠂⠀⠀⠀⠉⢃⣸⡏⠉⢉⣤⡿⢻⠃⠙⠆⠀⠀⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣟⠁⠀⠀⠈⠳⠀⠀⠀⠀⠀⠀⠉⢧⠀⢀⠀⠀⣠⢴⣿⣭⣿⣶⢻⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠓⢤⡀⠀⠘⠷⣶⣤⠀⠀⠀⠀⣸⠀⣘⡤⠚⢁⣾⣿⣿⣿⢿⡜⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠢⣄⠀⠀⠀⠀⠀⢀⣴⣷⠞⣁⣴⣾⣿⣿⣿⣿⠈⠀⠧⠸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣷⣤⣤⣴⣾⣿⣿⣴⣾⣿⣿⣿⣿⣿⣿⡉⠳⢄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠶⠀⠉⠓⠦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠞⠉⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠋⠁⠀⠀⠀⠀⠀⣠⠌⠓⢦⠀⠀⠀⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⡿⢀⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠋⠀⠀⠀⠀⠀⠀⠀⡠⠞⠁⠀⠀⠘⣆⠀⠀⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⡏⢀⣿⣿⣿⣿⣿⣿⣿⣿⡿⠛⠁⠀⢀⣤⡤⠔⠀⡠⠆⠀⠀⠀⠀⠀⠀⠀⠘⣄⠀⠀⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⢟⡿⠁⣼⣿⣿⣿⣿⣿⣿⠟⠉⠀⠀⠀⢿⡿⠋⠀⠀⠚⣁⡀⠀⠀⠀⠀⠀⢀⡠⠤⢬⣷⣄⠀⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⢃⡞⠀⢠⣿⣿⣿⣿⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⢴⣶⠶⠎⠁⠀⠀⠀⠤⠒⠉⠁⠀⠀⠀⠀⠙⣧⠀⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣃⡞⠀⢰⠸⣿⣿⡿⠉⠀⠀⠀⠻⡟⠁⠀⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⡇⠀⠀
#⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣃⡜⠀⠀⣾⡄⠈⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡐⠋⠀⠀⠀⠀⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣧⠀⠀
##########################################################################################
import customtkinter as ctk
import os
import requests as rq
import time as t
import psutil as ps

vent = ctk.CTk()
vent.geometry("1300x800")
vent.title("Command CENT")
vent.configure(fg_color="#311B14")

## FRAMES

wifi_frame = ctk.CTkFrame(
        vent,
        width=270,
        height=400,
        fg_color="#49291F"
)

def open_nmtui():
        os.system("kitty nmtui")
        

        

system_frrame = ctk.CTkFrame(
        vent,
        width=270,
        height=400,
        fg_color="#49291F"

)

system_header = ctk.CTkLabel(
        vent,
        text="System",
        font=("Monospace", 26, "bold"),
        text_color="white"
)

## WIFI, ETC

nmtui_button = ctk.CTkButton(
        wifi_frame,
        text="Wifi Networks",
        width=200,
        height=40,
        font=("Verdana", 13, "bold"),
        text_color="black",
        fg_color="#7B4533",
        hover_color="#C78974",
        cursor="hand2",
        command=open_nmtui
)
def reset_wifi():
        os.system("kitty sudo systemctl restart NetworkManager")




reset_wifibut = ctk.CTkButton(
        wifi_frame,
        text="Reset Wifi",
        font=("Verdana", 13, "bold"),
        width=200,
        height=40,
        text_color="black",
        fg_color="#7B4533",
        hover_color="#C78974",
        cursor="hand2",
        command=reset_wifi
)

is_wifi_label = ctk.CTkLabel(
        wifi_frame,
        text="Wifi: ",
        font=("Verdana", 19, "bold"),
)




def chequear_internet():
    try:
        # Intentamos conectar con Google. Si falla, el 'except' nos salva
        # Ponemos un timeout de 2 segundos para que no se quede colgado esperando
        r = rq.get("https://www.google.com", timeout=2)
        
        if r.status_code == 200:
            is_wifi_label.configure(text="Wifi: Yes", text_color="green")
        else:
            is_wifi_label.configure(text="Wifi: No", text_color="red")
            
    except Exception:
        # Aquí es donde el programa 'ignora' el error que viste en la terminal
        # En lugar de cerrarse, simplemente actualiza el texto
        is_wifi_label.configure(text="Wifi: No", text_color="red")

    # Esta línea es la que mantiene el programa vivo y revisando cada 5 segundos
    vent.after(2000, chequear_internet)


wifi_frame.propagate(False)
wifi_frame.pack_propagate(False)


label_wifi = ctk.CTkLabel(
        vent,
        text="Wifi",
        font=("Monospace", 26, "bold"),
        text_color="white"
)

def shutdown():
        os.system("notify-send ")
        t.sleep(2)
        os.system("shutdown now")

## HERE STARTS THE SYSTEM PART

system_frrame.pack_propagate(False)

shutdown_but = ctk.CTkButton(
        system_frrame,
        text="Shutdown",
        font=("Verdana", 13, "bold"),
        width=200,
        height=40,
        text_color="black",
        fg_color="#7B4533",
        hover_color="#C78974",
        cursor="hand2",
        command=shutdown
)

def reboot():
        os.system("reboot")


def list_procs():
        os.system("kitty python3 ~/.multilibs/listprocs.py normal")

proc_but = ctk.CTkButton(
        system_frrame,
        width=200,
        height=40,
        text="List Procs",
        font=("Verdana", 13, "bold"),
        text_color="black",
        fg_color="#7B4533",
        hover_color="#C78974",
        cursor="hand2",
        command=list_procs
)

def update():
        os.system("kitty sudo pacman -Syu")

update_but = ctk.CTkButton(
        system_frrame,
        width=200,
        height=40,
        text="Update System",
        font=("Verdana", 13, "bold"),
        text_color="black",
        fg_color="#7B4533",
        hover_color="#C78974",
        cursor="hand2",
        command=update
)


reboot_but = ctk.CTkButton(
        system_frrame,
        width=200,
        height=40,
        text="Reboot",
        font=("Verdana", 13, "bold"),
        text_color="black",
        fg_color="#7B4533",
        hover_color="#C78974",
        cursor="hand2",
        command=reboot
)
ram = ctk.CTkLabel(
                system_frrame,
                text=f"RAM%: ",
                font=("Monospace", 15, "bold")
        )
cpu = ctk.CTkLabel(
            system_frrame,
            text=f"CPU%: ",
            font=("Monospace", 15, "bold")     
        )
def cpunram():


        ram_usage = ps.virtual_memory().percent
        cpu_usage = ps.cpu_percent()
        
        ram.configure(text=f"RAM%: {ram_usage}")
        cpu.configure(text=f"CPU%: {cpu_usage}")

        vent.after(500, cpunram)


finder = ctk.CTkFrame(
        vent,
        fg_color="#49291F",
        width=400,
        height=400,
)

finder.pack_propagate(False)

findfile = ctk.CTkEntry(
        finder,
        placeholder_text="Find file...",
        placeholder_text_color="gray",
        height=42,
        width=200,
        

)






results_cage = ctk.CTkTextbox(
        finder,
        text_color="#C78974",
        width=250,
        height=400,
        font=("Monospace", 14, "bold")
        
)

def search():
        nombre = findfile.get()

        os.system(f"find ~ -name {nombre} > ~/Documents/results.txt")
        results_cage.delete("1.0", "end")
        archivo = os.path.expanduser("~/Documents/results.txt")

        with open(archivo, "r") as f:
                datos = f.read()
        results_cage.insert("1.0", datos)
       
searchbut = ctk.CTkButton(
        finder,
        text="Search",
        width=200,
        height=40,
        font=("Verdana", 13, "bold"),
        text_color="black",
        fg_color="#7B4533",
        hover_color="#C78974",
        cursor="hand2",
        command=search
)

si = ctk.CTkLabel(
        vent,
        text="Search",
        font=("Monospace", 26, "bold"),
        text_color="white"
)

## PLACING AND ORGANIZING THE WINDOW AND FRAMES
chequear_internet()
shutdown_but.pack(pady=10)
system_frrame.place(y=100, x=420)
nmtui_button.pack(pady=10)
system_header.place(y=60, x=505)
reset_wifibut.pack(pady=10)
is_wifi_label.pack(pady=10)
label_wifi.place(y=60, x=150)
reboot_but.pack(pady=10)
proc_but.pack(pady=10)
update_but.pack(pady=10)
ram.pack(pady=10)
cpu.pack(pady=10)
cpunram()
wifi_frame.place(y=100, x=50)
finder.place(y=100, x=780)
findfile.pack(pady=10)
searchbut.pack(pady=10)
results_cage.pack(pady=10)
si.place(y=60, x=920)
vent.after(1000, cpunram)
vent.mainloop()

